# 要件定義書：メディアDevダッシュボード

## 1. はじめに

本文書は、Webメディア事業の運営効率化とデータドリブンな意思決定を支援するために開発する、社内向け「メディアDevダッシュボード」の要件を定義するものである。

現在、事業のパフォーマンス指標は複数の外部サービスや社内ツールに散在しており、担当者の手動集計に多大な工数を要している。本プロジェクトは、これらのデータを一元的に集約・可視化するWebアプリケーションを構築することを目的とする。

特に、予算と実績の比較分析、およびメディア別のパフォーマンス分析を容易にすることで、事業担当者が分析と戦略立案に集中できる環境を実現する。

なお、実績データの自動収集機能（MCP）は本プロジェクトと分離し、独立したシステムとして開発する。本ダッシュボードは、MCPによってデータベースに格納された実績データを参照・利用する。

---

## 2. プロジェクト目的とスコープ

### 2.1. 目的

-   **データの一元化**: 散在する予実データを単一のデータベースに集約し、信頼できる唯一の情報源（Single Source of Truth）を構築する。
-   **業務効率の向上**: 手動でのデータ入力・集計作業を効率化する、洗練されたUIを提供する。
-   **意思決定の迅速化**: 全社およびメディア別のパフォーマンスをリアルタイムに近い鮮度で可視化し、迅速かつ的確な事業判断を支援する。
-   **予実管理精度の向上**: 予算と実績の乖離を容易に把握できるUIを提供し、目標達成に向けたアクションを促進する。

### 2.2. 主要スコープ

本プロジェクトのスコープは、以下の3つの主要機能群の開発とする。

-   **ダッシュボード機能**: 予実比較とメディア別パフォーマンスの可視化
-   **データ管理機能**: 予算データおよびマスターデータのCRUD操作
-   **設定・管理機能**: アプリケーション全体の動作設定

---

## 3. 機能要件

### 3.1. ダッシュボード機能

**予算と実績を比較し、事業状況を直感的に把握するための閲覧機能。**

-   **サマリー表示**: 全社、およびメディア別の主要KPI（売上、費用、利益など）について、当月の予算、実績、達成率、前月比、前年同月比を一覧表示する。
-   **時系列グラフ**: 主要KPIの推移を、予算と実績を比較する形で表示する。日次・月次・会計期単位での切り替えを可能とする。
-   **ドリルダウン分析**: メディア別、ASP別、勘定項目別など、複数の切り口でデータをフィルタリングし、深掘り分析ができる機能を提供する。

### 3.2. データ管理機能

**主に予算データをアップロード・修正するための機能。**

-   **スプレッドシート形式のUI**:
    -   メディアごと、勘定項目ごとに月次および日次の予算目標値を入力・更新できるUIを提供する。
    -   数値入力後、セルからフォーカスが外れるか、Enterキーを押下したタイミングでデータが自動保存される。
    -   親項目は子項目の合計値を自動計算して表示する。
-   **月次・日次連動**:
    -   月間目標値を入力すると、その値を日数で割り、日次目標値へ自動的に反映させる。
    -   逆に、日次目標値を変更すると、その合計値が月間目標値に自動で反映される。
-   **高度なCSVインポート機能**:
    -   **フォーマット対応**: `大項目, 小項目, 1月...` の階層化されたCSVフォーマットに対応する。
    -   **勘定項目の自動作成**: CSV内にシステム未登録の勘定項目が含まれていた場合、インポート時に自動でマスターデータへ追加する機能を提供する。
    -   **インテリジェントマッピング**: システム内の既存項目とCSV内の項目名が完全一致しない場合でも、類似度に基づいて最適なマッピングを自動で提案する。
    -   **プレビューと確認**: インポートを実行する前に、データのプレビューとマッピング結果、新規作成される項目を確認できるUIを提供する。
-   **CSVエクスポート機能**:
    -   現在表示している予算データを、階層化されたフォーマットでCSVファイルとしてダウンロードできる。

### 3.3. 設定・管理機能

**アプリケーションのマスターデータや動作を一元管理する機能。**

-   **メディア管理**:
    -   分析対象となるメディアの追加・編集・削除を行う。
    -   メディア名からURL用のスラッグを自動生成する。
-   **階層化勘定項目管理**:
    -   勘定項目を「大項目（カテゴリ）」と「小項目」の2階層で管理する。
    -   大項目の展開・折りたたみが可能なUIで、視覚的に分かりやすく項目を管理できる。
    -   ドラッグ＆ドロップによる表示順の変更に対応する。
-   **ユーザーと権限の管理**:
    -   ユーザーの招待、役割（ロール）の変更、担当メディアの割り当てを行う。
-   **会計期間管理**:
    -   事業の会計期（例：20期）や期首月（例：4月）を設定する。この設定は、データ集計期間の基準となる。

---

## 4. 連携システム

### 4.1. 実績データ自動収集機能 (Model Context Protocol - MCP)

-   実績データの自動収集機能は、本プロジェクトとは**別の独立したプロジェクト**として開発・運用する。
-   **役割**: MCPは、外部のASP管理画面などから実績データを定期的に自動取得し、本ダッシュボードと共有のデータベースにデータを書き込む責務を負う。
-   **連携**: 本ダッシュボードは、MCPによってデータベースに格納された実績データを読み取り、表示・分析に利用する。

---

## 5. 非機能要件

### 5.1. UI/UXデザイン

-   **デザイン哲学**: 「Less is more, simple is better. (より少ないことは、より豊かなこと。シンプルであることは、より良いこと。)」を基本原則とし、本質的な価値提供に繋がる、クリーンで直感的なデザインを目指す。
-   **レイアウト**: モダンなSPA（シングルページアプリケーション）として、固定のサイドナビゲーションとヘッダー、スクロール可能なメインコンテンツエリアで構成する。
-   **レスポンシブデザイン**: デスクトップからモバイルまで、様々な画面サイズで最適な表示と操作性を提供する。

### 5.2. パフォーマンス

-   すべてのページの表示は原則**3秒以内**に完了することを目指す。
-   データベースのテーブル設計やクエリは、読み取りコストと応答速度を最適化するよう配慮する。